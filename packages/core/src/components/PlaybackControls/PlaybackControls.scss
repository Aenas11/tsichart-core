@use "sass:list";
@use "sass:color";
@use "../../styles" as *;

// ============================================================================
// Configuration Variables
// ============================================================================
$playback-timeline-height: 32px;
$playback-button-size: 36px;
$playback-button-margin-top: 16px;
$playback-button-margin-bottom: 8px;
$playback-track-stroke-width: 5px;
$playback-handle-stroke-width: 2px;
$playback-timestamp-offset: -8px;
$playback-container-padding: 20px;
$playback-button-padding: 4px;
$playback-button-gap: 6px;

// ============================================================================
// CSS Custom Properties (Runtime Theming)
// ============================================================================
:root {
    // Light theme colors (default)
    --tsi-playback-track-active: #605E5C;
    --tsi-playback-track-inactive: #C8C6C4;
    --tsi-playback-handle-stroke: #323130;
    --tsi-playback-handle-fill: #fff;
    --tsi-playback-focus-color: #136bfb;
}

.tsi-dark {
    // Dark theme color overrides
    --tsi-playback-track-active: #8a8886;
    --tsi-playback-track-inactive: #3b3a39;
    --tsi-playback-handle-stroke: #d2d0ce;
    --tsi-playback-handle-fill: #1e2223;
}

// ============================================================================
// Component Styles
// ============================================================================

.tsi-playback-controls-container {
    padding-inline: $playback-container-padding;
}

.tsi-playback-timeline {
    width: 100%;
    height: $playback-timeline-height;
    position: relative;

    svg {
        width: 100%;
        height: 100%;
        position: absolute;
    }
}

.tsi-playback-input {
    position: absolute;
    pointer-events: none;
    height: 100%;
}

.tsi-playback-track,
.tsi-playback-handle {
    cursor: pointer;
}

.tsi-playback-track {
    stroke-width: $playback-track-stroke-width;
    stroke-linecap: round;

    .tsi-left-of-handle {
        stroke: var(--tsi-playback-track-active);
    }

    .tsi-right-of-handle {
        stroke: var(--tsi-playback-track-inactive);
    }
}

.tsi-playback-handle {
    stroke-width: $playback-handle-stroke-width;
    stroke: var(--tsi-playback-handle-stroke);
    fill: var(--tsi-playback-handle-fill);
    transition: transform 0.1s ease-out;

    &:hover {
        transform: "scale(1.1)";
    }

    &:active {
        transform: "scale(0.95)";
    }
}

.tsi-playback-axis {
    position: absolute;
    height: 100%;

    svg {
        width: 100%;
        height: 100%;
        overflow: visible;
    }
}

.tsi-playback-axis svg g {
    &:first-of-type {
        text-anchor: start;
    }

    &:last-of-type {
        text-anchor: end;
    }
}

.tsi-playback-buttons {
    display: flex;
    align-items: center;
    gap: $playback-button-gap;
    width: 100%;
    // height: $playback-button-size;
    margin-top: $playback-button-margin-top;
    margin-bottom: $playback-button-margin-bottom;

    button {
        padding: $playback-button-padding;
        background: none;
        border: none;
        background-repeat: no-repeat;
        background-position: center;
        cursor: pointer;
        width: $playback-button-size;
        height: $playback-button-size;
        border-radius: 2px;
        transition: background-color 0.2s ease;

        // Improved accessibility: custom focus indicator
        &:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--tsi-playback-focus-color);
        }

        // Remove focus ring for mouse users
        &:focus:not(:focus-visible) {
            box-shadow: none;
        }

        // Keyboard focus should always show
        &:focus-visible {
            box-shadow: 0 0 0 2px var(--tsi-playback-focus-color);
        }
    }
}

// ============================================================================
// Theme-Specific Styles
// ============================================================================

.tsi-light {
    .tsi-playback-buttons {
        button {
            &:hover {
                background-color: rgba(0, 0, 0, 0.05);
            }

            &:active {
                background-color: rgba(0, 0, 0, 0.1);
            }
        }

        .tsi-play-button {
            background-image: url(../../icons/Play_Icon_Light_Theme.svg);
        }

        .tsi-pause-button {
            background-image: url(../../icons/Pause_Icon_Light_Theme.svg);
        }
    }
}

.tsi-dark {
    .tsi-playback-buttons {
        button {
            &:hover {
                background-color: rgba(255, 255, 255, 0.08);
            }

            &:active {
                background-color: rgba(255, 255, 255, 0.12);
            }
        }

        .tsi-play-button {
            background-image: url(../../icons/Play_Icon_Dark_Theme.svg);
        }

        .tsi-pause-button {
            background-image: url(../../icons/Pause_Icon_Dark_Theme.svg);
        }
    }
}

.tsi-playback-timestamp {
    height: 100%;
    position: relative;
    top: $playback-timestamp-offset;
}